#pragma warning disable AA0005, AA0008, AA0018, AA0021, AA0072, AA0137, AA0201, AA0206, AA0218, AA0228, AL0424, AW0006 // ForNAV settings
dotnet // --> Reports ForNAV Autogenerated code - do not delete or modify
{	
	assembly("ForNav.Reports.6.3.0.2259")
	{
		type(ForNav.Report_6_3_0_2259; ForNavReport51516426_v6_3_0_2259){}   
	}
} // Reports ForNAV Autogenerated code - do not delete or modify -->

Report 51516426 "FORM 3 - DEPOSITS Return"
{
	RDLCLayout = './Layouts/FORM3-DEPOSITSReturn.rdlc'; DefaultLayout = RDLC;

	dataset
	{
		dataitem(Members;"Member Register")
		{
			CalcFields = "Current Shares";
			DataItemTableView = sorting("No.");
			RequestFilterFields = "Date Filter","No.";
			column(ReportForNavId_1102755000; 1102755000) {} // Autogenerated by ForNav - Do not delete
			column(CompanyName; Company.Name)
			{
			}
			column(Count1; COUNT1)
			{
			}
			column(Count2; COUNT2)
			{
			}
			column(Count3; COUNT3)
			{
			}
			column(Count4; COUNT4)
			{
			}
			column(Count5; COUNT5)
			{
			}
			column(Account1; ACOUNT1)
			{
			}
			column(Account2; ACOUNT2)
			{
			}
			column(Account3; ACOUNT3)
			{
			}
			column(Account4; ACOUNT4)
			{
			}
			column(Account5; ACOUNT5)
			{
			}
			column(Faccount1; FACOUNT1)
			{
			}
			column(Faccount2; FACOUNT2)
			{
			}
			column(Faccount3; FACOUNT3)
			{
			}
			column(Faccount4; FACOUNT4)
			{
			}
			column(Faccount5; FACOUNT5)
			{
			}
			column(Bal1; BAL1)
			{
			}
			column(Bal2; BAL2)
			{
			}
			column(Bal3; BAL3)
			{
			}
			column(Bal4; BAL4)
			{
			}
			column(Bal5; BAL5)
			{
			}
			column(Abal1; ABAL1)
			{
			}
			column(Abal2; ABAL2)
			{
			}
			column(Abal3; ABAL3)
			{
			}
			column(Abal4; ABAL4)
			{
			}
			column(Abal5; ABAL5)
			{
			}
			column(Fbal1; FABAL1)
			{
			}
			column(Fbal2; FABAL2)
			{
			}
			column(Fbal3; FABAL3)
			{
			}
			column(Fbal4; FABAL4)
			{
			}
			column(Fbal5; FABAL5)
			{
			}
			column(GrandCount; GRANDCOUNT)
			{
			}
			column(GrandTotal; GrandTotal)
			{
			}
			column(Sbal1; SBAL1)
			{
			}
			column(Sbal2; SBAL2)
			{
			}
			column(Sbal3; SBAL3)
			{
			}
			column(Sbal4; SBAL4)
			{
			}
			column(Sbal5; SBAL5)
			{
			}
			column(Sccount1; SACOUNT1)
			{
			}
			column(Sacount2; SACOUNT2)
			{
			}
			column(Sacount3; SACOUNT3)
			{
			}
			column(Sacount4; SACOUNT4)
			{
			}
			column(Sacount5; SACOUNT5)
			{
			}
			trigger OnPreDataItem();
			begin
				Company.Get;
				DFilter:=GetFilter(Members."Date Filter");
				Account.Reset;
				Account.SetRange(Account."Creditor Type",Account."creditor type"::"FOSA Account");
				Account.SetFilter(Account."Account Type",'<>%1 & <>%2','FIXED','CONTROL');
				Account.SetFilter(Account."No.",'<>0102-001-00010');
				Account.SetFilter(Account."Date Filter",DFilter);
				if Account.Find('-') then begin
				  repeat
					Account.CalcFields(Account.Balance);
					Balance:=Account.Balance;
					cnt+=1;
					if Balance<=50000 then begin
					ABAL1:=ABAL1+ Balance;
					ACOUNT1:=ACOUNT1+1;
					end else if (Balance>50000.01) and (Balance<=100000) then begin
					ABAL2:=ABAL2+ Balance;
					ACOUNT2:=ACOUNT2+1;
					end else if (Balance>100000.01) and (Balance<=300000) then begin
					ABAL3:=ABAL3+ Balance;
					ACOUNT3:=ACOUNT3+1;
					end else if (Balance>300000.01) and (Balance<=1000000) then begin
					ABAL4:=ABAL4+ Balance;
					ACOUNT4:=ACOUNT4+1;
					end else if Balance>1000000 then begin
					ABAL5:=ABAL5+ Balance;
					ACOUNT5:=ACOUNT5+1;
					end;
					GrandTotal+=ABAL1+ABAL2+ABAL3+ABAL4+ABAL5;
					GRANDCOUNT+=ACOUNT1+ACOUNT2+ACOUNT3+ACOUNT4+ACOUNT5;
				until Account.Next=0;
				end;
				Account.Reset;
				Account.SetFilter(Account."Account Type",'FIXED');
				Account.SetFilter(Account."Date Filter",DFilter);
				Account.SetFilter(Account."Net Change",'<>0');
				if Account.Find('-') then begin
				 repeat
					Account.CalcFields(Account."Net Change");
					Fbalance:=Account."Net Change";
					  if Fbalance<=50000 then begin
						  FABAL1:=FABAL1+ Fbalance;
						  FACOUNT1:=FACOUNT1+1;
						  end else if (Fbalance>50000.01) and (Fbalance<=100000) then begin
						  FABAL2:=FABAL2+ Fbalance;
						  FACOUNT2:=FACOUNT2+1;
						  end else if (Fbalance>100000.01) and (Fbalance<=300000) then begin
						  FABAL3:=FABAL3+ Fbalance;
						  FACOUNT3:=FACOUNT3+1;
						  end else if (Fbalance>300000.01) and (Fbalance<=1000000) then begin
						  FABAL4:=FABAL4+ Fbalance;
						  FACOUNT4:=FACOUNT4+1;
						  end else if Fbalance>1000000 then begin
						  FABAL5:=FABAL5+ Fbalance;
						  FACOUNT5:=FACOUNT5+1;
					end;
					GrandTotal+=FABAL1+FABAL2+FABAL3+FABAL4+FABAL5;
					GRANDCOUNT+=FACOUNT1+FACOUNT2+FACOUNT3+FACOUNT4+FACOUNT5;
				until Account.Next=0;
				end;
				GrandTotal:=BAL1+BAL2+BAL3+BAL4+BAL5+ABAL1+ABAL2+ABAL3+ABAL4+ABAL5+FABAL1+FABAL2+FABAL3+FABAL4+FABAL5;
				GRANDCOUNT:=COUNT1+COUNT2+COUNT3+COUNT4+COUNT5+ACOUNT1+ACOUNT2+ACOUNT3+ACOUNT4+ACOUNT5+FACOUNT1+FACOUNT2+FACOUNT3+FACOUNT4+FACOUNT5;
			end;
			
			trigger OnAfterGetRecord();
			begin
				SHARES:=0;
				Balance:=0;
				Fbalance:=0;
				GrandTotal:=0;
				Group:=0;
				Jaza:=0;
				CalcFields("Current Shares");
				CalcFields("Group Shares");
				SHARES:="Current Shares";
				Group:="Group Shares";
				//Non Withdrawable
				if (SHARES<>0) and(SHARES<=50000) then begin
				BAL1:=BAL1+SHARES;
				COUNT1:=COUNT1+1;
				end else if (SHARES>50000.01) and (SHARES<=100000) then begin
				BAL2:=BAL2+ SHARES;
				COUNT2:=COUNT2+1;
				end else if (SHARES>100000.01) and (SHARES<=300000) then begin
				BAL3:=BAL3+ SHARES;
				COUNT3:=COUNT3+1;
				end else if (SHARES>300000.01) and (SHARES<=1000000) then begin
				BAL4:=BAL4+ SHARES;
				COUNT4:=COUNT4+1;
				end else if SHARES>1000000 then begin
				BAL5:=BAL5+ SHARES;
				COUNT5:=COUNT5+1;
				end;
					//*****************
				if Members."Group Account No"<>'' then
				//Group Shares
				if (Group<>0) and(Group<=50000) then begin
				SBAL1:=SBAL1+Group;
				SACOUNT1:=SACOUNT1+1;
				end else if (Group>50000.01) and (Group<=100000) then begin
				SBAL2:=SBAL2+ Group;
				SACOUNT2:=SACOUNT2+1;
				end else if (Group>100000.01) and (Group<=300000) then begin
				SBAL3:=SBAL3+ Group;
				SACOUNT3:=SACOUNT3+1;
				end else if (Group>300000.01) and (Group<=1000000) then begin
				SBAL4:=SBAL4+ Group;
				SACOUNT4:=SACOUNT4+1;
				end else if Group>1000000 then begin
				SBAL5:=SBAL5+ Group;
				SACOUNT5:=SACOUNT5+1;
				end;
					 //*****************
				GrandTotal:=BAL1+BAL2+BAL3+BAL4+BAL5+ABAL1+ABAL2+ABAL3+ABAL4+ABAL5+FABAL1+FABAL2+FABAL3+FABAL4+FABAL5+SBAL1+SBAL2+SBAL3+SBAL4+SBAL5;
				GRANDCOUNT:=COUNT1+COUNT2+COUNT3+COUNT4+COUNT5+ACOUNT1+ACOUNT2+ACOUNT3+ACOUNT4+ACOUNT5+FACOUNT1+FACOUNT2+FACOUNT3+FACOUNT4+FACOUNT5+SACOUNT1+SACOUNT2+SACOUNT3+SACOUNT4+SACOUNT5;
				//new code
			end;
			
			trigger OnPostDataItem();
			begin
						 //   MESSAGE('Fosa : %1\Saye : %1\Xmas : %1\Sch : %1\Idd : %1\',FosaCount,SayeCount,XmasCount,SchCount,IddCount);
			end;
			
		}
	}

	requestpage
	{

  
		SaveValues = false;	  layout
		{
			area(content)
			{
				field(ASAT;ASAT)
				{
					ApplicationArea = Basic;
					Caption = 'As At..............';
					Visible = false;
				}
				field(ForNavOpenDesigner;ReportForNavOpenDesigner)
				{
					ApplicationArea = Basic;
					Caption = 'Design';
					Visible = ReportForNavAllowDesign;
						trigger OnValidate()
						begin
							ReportForNav.LaunchDesigner(ReportForNavOpenDesigner);
							CurrReport.RequestOptionsPage.Close();
						end;

				}
			}
		}

		actions
		{
		}
		trigger OnOpenPage()
		begin
			ReportForNavOpenDesigner := false;
		end;
	}

	trigger OnInitReport()
	begin
		;ReportsForNavInit;

	end;

	trigger OnPostReport()
	begin
		;ReportForNav.Post;
	end;

	trigger OnPreReport()
	begin
		;ReportsForNavPre;
	end;
	var
		Less50000: Decimal;
		"50000 to 10000": Decimal;
		"10000 t0 300000": Decimal;
		"300000 to 100000": Decimal;
		"over 1000000": Decimal;
		Account: Record Vendor;
		"Less50000-a/c": Decimal;
		"50000 to 10000-a/c": Decimal;
		"10000 t0 300000-a/c": Decimal;
		"300000 to 100000-a/c": Decimal;
		"over 1000000-a/c": Decimal;
		cust: Record "Member Register";
		SHARES: Decimal;
		BAL1: Decimal;
		BAL2: Decimal;
		BAL3: Decimal;
		BAL4: Decimal;
		BAL5: Decimal;
		COUNT1: Integer;
		COUNT2: Integer;
		COUNT3: Integer;
		COUNT4: Integer;
		COUNT5: Integer;
		ABAL1: Decimal;
		ABAL2: Decimal;
		ABAL3: Decimal;
		ABAL4: Decimal;
		ABAL5: Decimal;
		ACOUNT1: Integer;
		ACOUNT2: Integer;
		ACOUNT3: Integer;
		ACOUNT4: Integer;
		ACOUNT5: Integer;
		Balance: Decimal;
		FABAL1: Decimal;
		FABAL2: Decimal;
		FABAL3: Decimal;
		FABAL4: Decimal;
		FABAL5: Decimal;
		FACOUNT1: Integer;
		FACOUNT2: Integer;
		FACOUNT3: Integer;
		FACOUNT4: Integer;
		FACOUNT5: Integer;
		Fbalance: Decimal;
		GrandTotal: Decimal;
		GRANDCOUNT: Integer;
		DFilter: Text[50];
		ASAT: Date;
		Company: Record "Company Information";
		vend: Record Vendor;
		Jaza: Decimal;
		SAYE: Decimal;
		SCH: Decimal;
		IDD: Decimal;
		XMAS: Decimal;
		Savings: Decimal;
		cnt: Decimal;
		SayeCount: Decimal;
		XmasCount: Decimal;
		IddCount: Decimal;
		DepositCount: Decimal;
		FosaCount: Decimal;
		SchCount: Decimal;
		SchoolFees: Decimal;
		SBAL1: Decimal;
		SBAL2: Decimal;
		SBAL3: Decimal;
		SBAL4: Decimal;
		SBAL5: Decimal;
		SACOUNT1: Integer;
		SACOUNT2: Integer;
		SACOUNT3: Integer;
		SACOUNT4: Integer;
		SACOUNT5: Integer;
		Group: Decimal;

	// --> Reports ForNAV Autogenerated code - do not delete or modify
	var 
		[WithEvents]
		ReportForNav : DotNet ForNavReport51516426_v6_3_0_2259;
		ReportForNavOpenDesigner : Boolean;
		[InDataSet]
		ReportForNavAllowDesign : Boolean;

	local procedure ReportsForNavInit();
	var
		ApplicationSystemConstants: Codeunit "Application System Constants";
		addInFileName : Text;
		tempAddInFileName : Text;
		path: DotNet Path;
		ReportForNavObject: Variant;
	begin
		addInFileName := ApplicationPath() + 'Add-ins\ReportsForNAV_6_3_0_2259\ForNav.Reports.6.3.0.2259.dll';
		if not File.Exists(addInFileName) then begin
			tempAddInFileName := path.GetTempPath() + '\Microsoft Dynamics NAV\Add-Ins\' + ApplicationSystemConstants.PlatformFileVersion() + '\ForNav.Reports.6.3.0.2259.dll';
			if not File.Exists(tempAddInFileName) then
				Error('Please install the ForNAV DLL version 6.3.0.2259 in your service tier Add-ins folder under the file name "%1"\\If you already have the ForNAV DLL on the server, you should move it to this folder and rename it to match this file name.', addInFileName);
		end;
		ReportForNavObject := ReportForNav.GetLatest(CurrReport.OBJECTID, CurrReport.Language, SerialNumber, UserId, CompanyName);
		ReportForNav := ReportForNavObject;
		ReportForNav.Init();
	end;

	local procedure ReportsForNavPre();
	begin
		ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;
		if not ReportForNav.Pre() then CurrReport.Quit();
	end;

	// Reports ForNAV Autogenerated code - do not delete or modify -->
}
